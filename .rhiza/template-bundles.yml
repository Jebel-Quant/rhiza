# Rhiza Template Bundle Definitions
# Version: 1.0.0
#
# This file defines template bundles - pre-configured sets of files that can be
# included in downstream projects by selecting templates instead of listing
# individual file paths.
#
# Usage in downstream projects (.rhiza/template.yml):
#
#   templates:
#     - tests
#     - docker
#     - marimo
#
# Instead of manually listing:
#
#   include: |
#     .rhiza/make.d/01-test.mk
#     pytest.ini
#     tests/**
#     docker/Dockerfile
#     ...

version: "1.0"

# Bundle Definitions
bundles:
  # ============================================================================
  # CORE - Required infrastructure (always included automatically)
  # ============================================================================
  core:
    description: "Core Rhiza infrastructure - always included automatically"
    required: true
    standalone: true
    files:
      # Core Rhiza files
      - .rhiza/rhiza.mk
      - .rhiza/.cfg.toml
      - .rhiza/.env
      - .rhiza/.gitignore
      - .rhiza/.rhiza-version
      - .rhiza/make.d/00-custom-env.mk
      - .rhiza/make.d/05-github.mk
      - .rhiza/make.d/06-agentic.mk
      - .rhiza/make.d/08-docs.mk
      - .rhiza/make.d/10-custom-task.mk
      - .rhiza/make.d/README.md
      - .rhiza/scripts/**
      - .rhiza/utils/**
      - .rhiza/docs/**
      - .rhiza/assets/**
      - .rhiza/requirements/uv.txt
      
      # Root configuration files
      - Makefile
      - .pre-commit-config.yaml
      - .editorconfig
      - .gitignore
      - .python-version
      - ruff.toml
      - renovate.json
      - pyproject.toml
      
      # Documentation files
      - LICENSE
      - README.md
      - CONTRIBUTING.md
      - CODE_OF_CONDUCT.md
      - SECURITY.md
      - PRESENTATION.md
      - docs/ARCHITECTURE.md
      - docs/CUSTOMIZATION.md
      - docs/GLOSSARY.md
      - docs/QUICK_REFERENCE.md
      - docs/RELEASING.md
      - docs/WORKFLOWS.md
      - docs/ASSETS.md
      - docs/DEMO.md
      
      # Core GitHub Actions workflows
      - .github/workflows/rhiza_validate.yml
      - .github/workflows/rhiza_sync.yml
      - .github/workflows/rhiza_pre-commit.yml
      - .github/workflows/rhiza_deptry.yml
      - .github/workflows/rhiza_release.yml
      - .github/actions/configure-git-auth/**
      - .github/dependabot.yml
      - .github/copilot-instructions.md
      - .github/agents/**

  # ============================================================================
  # TESTS - Testing infrastructure with pytest, coverage, and benchmarks
  # ============================================================================
  tests:
    description: "Testing infrastructure with pytest, coverage, and benchmarks"
    standalone: true
    requires: []
    files:
      # Make targets and configuration
      - .rhiza/make.d/01-test.mk
      - .rhiza/requirements/tests.txt
      - pytest.ini
      
      # Test directory and all test files
      - tests/**
      
      # GitHub Actions workflows
      - .github/workflows/rhiza_ci.yml
      - .github/workflows/rhiza_benchmarks.yml
      - .github/workflows/rhiza_mypy.yml
      - .github/workflows/rhiza_security.yml
      - .github/workflows/rhiza_codeql.yml
      
      # GitLab CI workflows
      - .gitlab/workflows/rhiza_ci.yml

  # ============================================================================
  # DOCKER - Docker containerization support
  # ============================================================================
  docker:
    description: "Docker containerization support for building and running containers"
    standalone: true
    requires: []
    files:
      # Docker configuration and files
      - docker/Dockerfile
      - docker/Dockerfile.dockerignore
      
      # Make targets
      - .rhiza/make.d/07-docker.mk
      
      # Documentation
      - docs/DOCKER.md
      
      # GitHub Actions workflows
      - .github/workflows/rhiza_docker.yml

  # ============================================================================
  # MARIMO - Interactive Marimo notebooks
  # ============================================================================
  marimo:
    description: "Interactive Marimo notebooks for data exploration and documentation"
    standalone: true
    requires: []
    files:
      # Marimo configuration
      - .rhiza/make.d/03-marimo.mk
      - .rhiza/requirements/marimo.txt
      
      # Marimo notebooks directory
      - book/marimo/**
      
      # Documentation
      - docs/MARIMO.md
      
      # GitHub Actions workflows
      - .github/workflows/rhiza_marimo.yml
      
      # GitLab templates
      - .gitlab/template/marimo_job_template.yml.jinja

  # ============================================================================
  # BOOK - Documentation book generation
  # ============================================================================
  book:
    description: |
      Comprehensive documentation book generation combining:
      - API documentation (pdoc)
      - Test coverage reports
      - Test results
      - Interactive notebooks (if marimo is enabled)
    standalone: false
    requires:
      - tests  # Required: book needs test coverage and reports
    recommends:
      - marimo  # Optional: book works better with notebook exports
    files:
      # Book building configuration
      - .rhiza/make.d/02-book.mk
      - .rhiza/templates/minibook/**
      
      # Documentation
      - docs/BOOK.md
      
      # GitHub Actions workflows
      - .github/workflows/rhiza_book.yml
      
      # GitLab CI workflows
      - .gitlab/workflows/rhiza_book.yml

  # ============================================================================
  # DEVCONTAINER - VS Code DevContainer configuration
  # ============================================================================
  devcontainer:
    description: "VS Code DevContainer configuration for consistent development environments"
    standalone: true
    requires: []
    files:
      # DevContainer configuration
      - .devcontainer/devcontainer.json
      - .devcontainer/bootstrap.sh
      
      # Documentation
      - docs/DEVCONTAINER.md
      
      # GitHub Actions workflows
      - .github/workflows/rhiza_devcontainer.yml

  # ============================================================================
  # GITLAB - GitLab CI/CD pipeline configuration
  # ============================================================================
  gitlab:
    description: "GitLab CI/CD pipeline configuration and workflows"
    standalone: true
    requires: []
    notes: |
      GitLab workflows provide similar functionality to GitHub Actions.
      Some workflows (like book, ci) may benefit from having their
      corresponding feature templates (book, tests) also enabled.
    files:
      # Main GitLab CI configuration
      - .gitlab-ci.yml
      
      # GitLab workflow files
      - .gitlab/workflows/rhiza_book.yml
      - .gitlab/workflows/rhiza_ci.yml
      - .gitlab/workflows/rhiza_deptry.yml
      - .gitlab/workflows/rhiza_pre-commit.yml
      - .gitlab/workflows/rhiza_release.yml
      - .gitlab/workflows/rhiza_renovate.yml
      - .gitlab/workflows/rhiza_sync.yml
      - .gitlab/workflows/rhiza_validate.yml
      
      # GitLab templates
      - .gitlab/template/**
      
      # GitLab documentation
      - .gitlab/COMPARISON.md
      - .gitlab/README.md
      - .gitlab/SUMMARY.md
      - .gitlab/TESTING.md

  # ============================================================================
  # PRESENTATION - Presentation building with reveal.js
  # ============================================================================
  presentation:
    description: "Presentation building using reveal.js and Marimo"
    standalone: true
    requires: []
    recommends:
      - marimo  # Presentations often use Marimo for interactive slides
    files:
      - .rhiza/make.d/04-presentation.mk
      - docs/PRESENTATION.md

# ============================================================================
# Bundle Metadata
# ============================================================================
metadata:
  total_bundles: 8
  required_bundles: 1  # core
  standalone_bundles: 7
  composite_bundles: 1  # book (requires tests)
  
  # Statistics
  file_counts:
    core: "~30 files"
    tests: "~30+ files"
    docker: "~5 files"
    marimo: "~6 files"
    book: "~5 files"
    devcontainer: "~4 files"
    gitlab: "~15 files"
    presentation: "~2 files"

# ============================================================================
# Example Configurations
# ============================================================================
examples:
  minimal:
    description: "Minimal Python project with just testing"
    templates:
      - tests
    
  docker_service:
    description: "Docker-based microservice"
    templates:
      - tests
      - docker
  
  data_science:
    description: "Data science project with notebooks and documentation"
    templates:
      - tests
      - marimo
      - book
  
  full_featured:
    description: "Full-featured project with all capabilities"
    templates:
      - tests
      - docker
      - marimo
      - book
      - devcontainer
  
  gitlab_project:
    description: "GitLab-focused project"
    templates:
      - tests
      - docker
      - gitlab

# ============================================================================
# Version History
# ============================================================================
changelog:
  "1.0":
    date: "2025-02-04"
    changes:
      - "Initial template bundle system"
      - "Defined 8 core bundles: core, tests, docker, marimo, book, devcontainer, gitlab, presentation"
      - "Implemented dependency resolution (book requires tests)"
      - "Added recommendation system (book recommends marimo)"
